(()=>{var e={};e.id=72,e.ids=[72],e.modules={11185:e=>{"use strict";e.exports=require("mongoose")},47849:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external")},72934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},55403:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external")},54580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},94749:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external")},45869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},20399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},6113:e=>{"use strict";e.exports=require("crypto")},57147:e=>{"use strict";e.exports=require("fs")},13685:e=>{"use strict";e.exports=require("http")},95687:e=>{"use strict";e.exports=require("https")},6005:e=>{"use strict";e.exports=require("node:crypto")},87561:e=>{"use strict";e.exports=require("node:fs")},49411:e=>{"use strict";e.exports=require("node:path")},71017:e=>{"use strict";e.exports=require("path")},63477:e=>{"use strict";e.exports=require("querystring")},12781:e=>{"use strict";e.exports=require("stream")},57310:e=>{"use strict";e.exports=require("url")},73837:e=>{"use strict";e.exports=require("util")},59796:e=>{"use strict";e.exports=require("zlib")},51949:(e,t,a)=>{"use strict";a.r(t),a.d(t,{GlobalError:()=>d.a,__next_app__:()=>f,originalPathname:()=>l,pages:()=>b,routeModule:()=>u,tree:()=>o});var r=a(90570),i=a(68179),n=a(52696),d=a.n(n),c=a(5666),s={};for(let e in c)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(s[e]=()=>c[e]);a.d(t,s);let o=["",{children:["(root)",{children:["transformations",{children:["[id]",{children:["update",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(a.bind(a,54975)),"D:\\visual studio code\\project\\learn React and Nextjs\\imaginify\\app\\(root)\\transformations\\[id]\\update\\page.tsx"]}]},{}]},{}]},{}]},{layout:[()=>Promise.resolve().then(a.bind(a,30770)),"D:\\visual studio code\\project\\learn React and Nextjs\\imaginify\\app\\(root)\\layout.tsx"],"not-found":[()=>Promise.resolve().then(a.t.bind(a,94084,23)),"next/dist/client/components/not-found-error"],metadata:{icon:[async e=>(await Promise.resolve().then(a.bind(a,51677))).default(e)],apple:[],openGraph:[],twitter:[],manifest:void 0}}]},{layout:[()=>Promise.resolve().then(a.bind(a,81292)),"D:\\visual studio code\\project\\learn React and Nextjs\\imaginify\\app\\layout.tsx"],"not-found":[()=>Promise.resolve().then(a.t.bind(a,94084,23)),"next/dist/client/components/not-found-error"],metadata:{icon:[async e=>(await Promise.resolve().then(a.bind(a,51677))).default(e)],apple:[],openGraph:[],twitter:[],manifest:void 0}}],b=["D:\\visual studio code\\project\\learn React and Nextjs\\imaginify\\app\\(root)\\transformations\\[id]\\update\\page.tsx"],l="/(root)/transformations/[id]/update/page",f={require:a,loadChunk:()=>Promise.resolve()},u=new r.AppPageRouteModule({definition:{kind:i.x.APP_PAGE,page:"/(root)/transformations/[id]/update/page",pathname:"/transformations/[id]/update",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:o}})},47552:(e,t,a)=>{let r={"0e337730f08db15233ccdf85fca8a91f7c727e39":()=>Promise.resolve().then(a.bind(a,84195)).then(e=>e.syncKeylessConfigAction),"55de01d7dcc8b9efeb7c350f664e86664eea24d7":()=>Promise.resolve().then(a.bind(a,84195)).then(e=>e.deleteKeylessAction),f82c53323200eba1d8cabd668014c33f05ccac10:()=>Promise.resolve().then(a.bind(a,84195)).then(e=>e.createOrReadKeylessAction),"51ee5b3c432bda2517692ab88bb54e3fca12ee4c":()=>Promise.resolve().then(a.bind(a,7329)).then(e=>e.getUserImages),"7a9f1c74bb35fe3340284e9fafea878d42b8dc54":()=>Promise.resolve().then(a.bind(a,7329)).then(e=>e.getAllImages),"902051a992baae2f5785ca7add274ba34cc7becb":()=>Promise.resolve().then(a.bind(a,7329)).then(e=>e.updateImage),"934028fdc0be84685f832b78fc10dba1d10216a3":()=>Promise.resolve().then(a.bind(a,7329)).then(e=>e.addImage),dfd21a0dec0629a0528d8f07f8196a742310df7c:()=>Promise.resolve().then(a.bind(a,7329)).then(e=>e.getImageById),e22676a53c5de1d297ab088741d73b9758d0ed3b:()=>Promise.resolve().then(a.bind(a,7329)).then(e=>e.deleteImage),"142443fc102798e02caf7749c72c67d88cc0d1f9":()=>Promise.resolve().then(a.bind(a,43767)).then(e=>e.createUser),"1bd2439848cce1253a71f69a051c88b31fb54b8f":()=>Promise.resolve().then(a.bind(a,43767)).then(e=>e.deleteUser),"865460400823edc85e8779e5b6640367cd36aa48":()=>Promise.resolve().then(a.bind(a,43767)).then(e=>e.updateCredits),"917bd2a2bbafa2bbf2cb903406452986486715b2":()=>Promise.resolve().then(a.bind(a,43767)).then(e=>e.updateUser),"9eeec8055808c1780baee03e37e448f0d44736f1":()=>Promise.resolve().then(a.bind(a,43767)).then(e=>e.getUserById)};async function i(e,...t){return(await r[e]()).apply(null,t)}e.exports={"0e337730f08db15233ccdf85fca8a91f7c727e39":i.bind(null,"0e337730f08db15233ccdf85fca8a91f7c727e39"),"55de01d7dcc8b9efeb7c350f664e86664eea24d7":i.bind(null,"55de01d7dcc8b9efeb7c350f664e86664eea24d7"),f82c53323200eba1d8cabd668014c33f05ccac10:i.bind(null,"f82c53323200eba1d8cabd668014c33f05ccac10"),"51ee5b3c432bda2517692ab88bb54e3fca12ee4c":i.bind(null,"51ee5b3c432bda2517692ab88bb54e3fca12ee4c"),"7a9f1c74bb35fe3340284e9fafea878d42b8dc54":i.bind(null,"7a9f1c74bb35fe3340284e9fafea878d42b8dc54"),"902051a992baae2f5785ca7add274ba34cc7becb":i.bind(null,"902051a992baae2f5785ca7add274ba34cc7becb"),"934028fdc0be84685f832b78fc10dba1d10216a3":i.bind(null,"934028fdc0be84685f832b78fc10dba1d10216a3"),dfd21a0dec0629a0528d8f07f8196a742310df7c:i.bind(null,"dfd21a0dec0629a0528d8f07f8196a742310df7c"),e22676a53c5de1d297ab088741d73b9758d0ed3b:i.bind(null,"e22676a53c5de1d297ab088741d73b9758d0ed3b"),"142443fc102798e02caf7749c72c67d88cc0d1f9":i.bind(null,"142443fc102798e02caf7749c72c67d88cc0d1f9"),"1bd2439848cce1253a71f69a051c88b31fb54b8f":i.bind(null,"1bd2439848cce1253a71f69a051c88b31fb54b8f"),"865460400823edc85e8779e5b6640367cd36aa48":i.bind(null,"865460400823edc85e8779e5b6640367cd36aa48"),"917bd2a2bbafa2bbf2cb903406452986486715b2":i.bind(null,"917bd2a2bbafa2bbf2cb903406452986486715b2"),"9eeec8055808c1780baee03e37e448f0d44736f1":i.bind(null,"9eeec8055808c1780baee03e37e448f0d44736f1")}},56469:(e,t,a)=>{let r={d9d0562c8baa631417ca06c17e3e81bbbbbaf18e:()=>Promise.resolve().then(a.bind(a,72891)).then(e=>e.invalidateCacheAction)};async function i(e,...t){return(await r[e]()).apply(null,t)}e.exports={d9d0562c8baa631417ca06c17e3e81bbbbbaf18e:i.bind(null,"d9d0562c8baa631417ca06c17e3e81bbbbbaf18e")}},56611:(e,t,a)=>{Promise.resolve().then(a.bind(a,69047))},54975:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>f,metadata:()=>l});var r=a(50798),i=a(49463),n=a(51013),d=a(6088),c=a(67448),s=a(3222),o=a(43767),b=a(7329);let l={title:"Update Image | Remove Shadow",description:"Update image in your account using Remove Shadow's AI image transformation services",robots:{index:!1,follow:!1}},f=async({params:{id:e}})=>{let{userId:t}=await (0,i.I)();t||(0,n.redirect)("/sign-in");let a=await (0,o.getUserById)(t),l=await (0,b.getImageById)(e),f=s.vB[l.transformationType];return(0,r.jsxs)(r.Fragment,{children:[r.jsx(d.Z,{title:f.title,subtitle:f.subTitle}),r.jsx("section",{className:"mt-10",children:r.jsx(c.ZP,{action:"Update",userId:a._id,type:l.transformationType,creditBalance:a.creditBalance,config:l.config,data:l})})]})}},7329:(e,t,a)=>{"use strict";a.r(t),a.d(t,{addImage:()=>m,deleteImage:()=>g,getAllImages:()=>x,getImageById:()=>y,getUserImages:()=>v,updateImage:()=>h});var r=a(88775);a(68775);var i=a(50060),n=a(63647),d=a(88437),c=a(21403),s=a(11185);let o=new s.Schema({title:{type:String,required:!0},transformationType:{type:String,required:!0},publicId:{type:String,required:!0},secureURL:{type:String,required:!0},width:{type:Number},height:{type:Number},config:{type:Object},transformationUrl:{type:String},aspectRatio:{type:String},color:{type:String},prompt:{type:String},author:{type:s.Schema.Types.ObjectId,ref:"User"},createdAt:{type:Date,default:Date.now},updatedAt:{type:Date,default:Date.now}}),b=s.models?.Image||(0,s.model)("Image",o);var l=a(51013),f=a(74277),u=a(69303);let p=e=>e.populate({path:"author",model:c.Z,select:"_id firstName lastName clerkId"});async function m({image:e,userId:t,path:a}){try{await (0,n.v)();let r=await c.Z.findById(t);if(!r)throw Error("User not found");let d=await b.create({...e,author:r._id});return(0,i.revalidatePath)(a),JSON.parse(JSON.stringify(d))}catch(e){(0,d.S3)(e)}}async function h({image:e,userId:t,path:a}){try{await (0,n.v)();let r=await b.findById(e._id);if(!r||r.author.toHexString()!==t)throw Error("Unauthorized or image not found");let d=await b.findByIdAndUpdate(r._id,e,{new:!0});return(0,i.revalidatePath)(a),JSON.parse(JSON.stringify(d))}catch(e){(0,d.S3)(e)}}async function g(e){try{await (0,n.v)(),await b.findByIdAndDelete(e)}catch(e){(0,d.S3)(e)}finally{(0,l.redirect)("/")}}async function y(e){try{await (0,n.v)();let t=await p(b.findById(e));if(!t)throw Error("Image not found");return JSON.parse(JSON.stringify(t))}catch(e){(0,d.S3)(e)}}async function x({limit:e=9,page:t=1,searchQuery:a=""}){try{await (0,n.v)(),f.v2.config({cloud_name:"dpokgg5g5",api_key:process.env.CLOUDINARY_API_KEY,api_secret:process.env.CLOUDINARY_API_SECRET,secure:!0});let r="folder=imaginify";a&&(r+=` AND ${a}`);let{resources:i}=await f.v2.search.expression(r).execute(),d=i.map(e=>e.public_id),c={};a&&(c={publicId:{$in:d}});let s=(Number(t)-1)*e,o=await p(b.find(c)).sort({updatedAt:-1}).skip(s).limit(e),l=await b.find(c).countDocuments(),u=await b.find().countDocuments();return{data:JSON.parse(JSON.stringify(o)),totalPage:Math.ceil(l/e),savedImages:u}}catch(e){(0,d.S3)(e)}}async function v({limit:e=9,page:t=1,userId:a}){try{await (0,n.v)();let r=(Number(t)-1)*e,i=await p(b.find({author:a})).sort({updatedAt:-1}).skip(r).limit(e),d=await b.find({author:a}).countDocuments();return{data:JSON.parse(JSON.stringify(i)),totalPages:Math.ceil(d/e)}}catch(e){(0,d.S3)(e)}}(0,u.h)([m,h,g,y,x,v]),(0,r.U)("934028fdc0be84685f832b78fc10dba1d10216a3",m),(0,r.U)("902051a992baae2f5785ca7add274ba34cc7becb",h),(0,r.U)("e22676a53c5de1d297ab088741d73b9758d0ed3b",g),(0,r.U)("dfd21a0dec0629a0528d8f07f8196a742310df7c",y),(0,r.U)("7a9f1c74bb35fe3340284e9fafea878d42b8dc54",x),(0,r.U)("51ee5b3c432bda2517692ab88bb54e3fca12ee4c",v)}};var t=require("../../../../../webpack-runtime.js");t.C(e);var a=e=>t(t.s=e),r=t.X(0,[867,263,492,611,543,386,60,277,275,49,685,817],()=>a(51949));module.exports=r})();