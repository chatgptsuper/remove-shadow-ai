"use strict";exports.id=817,exports.ids=[817],exports.modules={69047:(e,a,t)=>{t.r(a),t.d(a,{default:()=>H,formSchema:()=>G});var s=t(69805),r=t(56189),l=t(54583),i=t(33322),o=t(3327),d=t(43836),n=t(92275),c=t(31119),m=t(24619),f=t(47267);let u=d.fC;d.ZA;let p=d.B4,h=o.forwardRef(({className:e,children:a,...t},r)=>(0,s.jsxs)(d.xz,{ref:r,className:(0,f.cn)("flex h-10 w-full items-center justify-between rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background data-[placeholder]:text-muted-foreground focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 [&>span]:line-clamp-1",e),...t,children:[a,s.jsx(d.JO,{asChild:!0,children:s.jsx(n.Z,{className:"h-4 w-4 opacity-50"})})]}));h.displayName=d.xz.displayName;let x=o.forwardRef(({className:e,...a},t)=>s.jsx(d.u_,{ref:t,className:(0,f.cn)("flex cursor-default items-center justify-center py-1",e),...a,children:s.jsx(c.Z,{className:"h-4 w-4"})}));x.displayName=d.u_.displayName;let g=o.forwardRef(({className:e,...a},t)=>s.jsx(d.$G,{ref:t,className:(0,f.cn)("flex cursor-default items-center justify-center py-1",e),...a,children:s.jsx(n.Z,{className:"h-4 w-4"})}));g.displayName=d.$G.displayName;let b=o.forwardRef(({className:e,children:a,position:t="popper",...r},l)=>s.jsx(d.h_,{children:(0,s.jsxs)(d.VY,{ref:l,className:(0,f.cn)("relative z-50 max-h-96 min-w-[8rem] overflow-hidden rounded-md border bg-popover text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2","popper"===t&&"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1",e),position:t,...r,children:[s.jsx(x,{}),s.jsx(d.l_,{className:(0,f.cn)("p-1","popper"===t&&"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)]"),children:a}),s.jsx(g,{})]})}));b.displayName=d.VY.displayName,o.forwardRef(({className:e,...a},t)=>s.jsx(d.__,{ref:t,className:(0,f.cn)("py-1.5 pl-8 pr-2 text-sm font-semibold",e),...a})).displayName=d.__.displayName;let N=o.forwardRef(({className:e,children:a,...t},r)=>(0,s.jsxs)(d.ck,{ref:r,className:(0,f.cn)("relative flex w-full cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",e),...t,children:[s.jsx("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:s.jsx(d.wU,{children:s.jsx(m.Z,{className:"h-4 w-4"})})}),s.jsx(d.eT,{children:a})]}));N.displayName=d.ck.displayName,o.forwardRef(({className:e,...a},t)=>s.jsx(d.Z0,{ref:t,className:(0,f.cn)("-mx-1 my-1 h-px bg-muted",e),...a})).displayName=d.Z0.displayName;var j=t(22091),y=t(30658),w=t(99790);let v=(0,t(91944).j)("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),R=o.forwardRef(({className:e,...a},t)=>s.jsx(w.f,{ref:t,className:(0,f.cn)(v(),e),...a}));R.displayName=w.f.displayName;let I=l.RV,S=o.createContext({}),k=({...e})=>s.jsx(S.Provider,{value:{name:e.name},children:s.jsx(l.Qr,{...e})}),C=()=>{let e=o.useContext(S),a=o.useContext(U),{getFieldState:t,formState:s}=(0,l.Gc)(),r=t(e.name,s);if(!e)throw Error("useFormField should be used within <FormField>");let{id:i}=a;return{id:i,name:e.name,formItemId:`${i}-form-item`,formDescriptionId:`${i}-form-item-description`,formMessageId:`${i}-form-item-message`,...r}},U=o.createContext({}),$=o.forwardRef(({className:e,...a},t)=>{let r=o.useId();return s.jsx(U.Provider,{value:{id:r},children:s.jsx("div",{ref:t,className:(0,f.cn)("space-y-2",e),...a})})});$.displayName="FormItem";let z=o.forwardRef(({className:e,...a},t)=>{let{error:r,formItemId:l}=C();return s.jsx(R,{ref:t,className:(0,f.cn)(r&&"text-destructive",e),htmlFor:l,...a})});z.displayName="FormLabel";let O=o.forwardRef(({...e},a)=>{let{error:t,formItemId:r,formDescriptionId:l,formMessageId:i}=C();return s.jsx(y.g7,{ref:a,id:r,"aria-describedby":t?`${l} ${i}`:`${l}`,"aria-invalid":!!t,...e})});O.displayName="FormControl",o.forwardRef(({className:e,...a},t)=>{let{formDescriptionId:r}=C();return s.jsx("p",{ref:t,id:r,className:(0,f.cn)("text-sm text-muted-foreground",e),...a})}).displayName="FormDescription";let _=o.forwardRef(({className:e,children:a,...t},r)=>{let{error:l,formMessageId:i}=C(),o=l?String(l?.message??""):a;return o?s.jsx("p",{ref:r,id:i,className:(0,f.cn)("text-sm font-medium text-destructive",e),...t,children:o}):null});_.displayName="FormMessage";var Z=t(74496),D=t(66389);let F=({control:e,render:a,name:t,formLabel:r,className:l})=>s.jsx(k,{control:e,name:t,render:({field:e})=>(0,s.jsxs)($,{className:l,children:[r&&s.jsx(z,{children:r}),s.jsx(O,{children:a({field:e})}),s.jsx(_,{})]})});t(34298);var T=t(82679),A=(0,T.$)("865460400823edc85e8779e5b6640367cd36aa48");(0,T.$)("142443fc102798e02caf7749c72c67d88cc0d1f9"),(0,T.$)("9eeec8055808c1780baee03e37e448f0d44736f1"),(0,T.$)("917bd2a2bbafa2bbf2cb903406452986486715b2"),(0,T.$)("1bd2439848cce1253a71f69a051c88b31fb54b8f");var L=t(47418),V=t(66275),B=t(98043);let E=({onValueChange:e,setImage:a,image:t,publicId:r,type:l})=>s.jsx(V.ZF,{uploadPreset:"JSM_imaginify",options:{multiple:!1,resourceType:"image"},onSuccess:t=>{a(e=>({...e,publicId:t?.info?.public_id,width:t?.info?.width,height:t?.info?.height,secureURL:t?.info?.secure_url})),e(t?.info?.public_id),L.toast.success("Image uploaded successfully",{description:"1 credit was deducted from your account",duration:5e3,className:"success-toast"})},onError:()=>{L.toast.success("Something went wrong while uploading",{description:"Please try again",duration:5e3,className:"error-toast"})},children:({open:e})=>(0,s.jsxs)("div",{className:"flex flex-col gap-4",children:[s.jsx("h3",{className:"h3-bold text-dark-600",children:"Original"}),r?s.jsx(s.Fragment,{children:s.jsx("div",{className:"cursor-pointer overflow-hidden rounde-[10px",children:s.jsx(V.bz,{width:(0,f.Ad)(l,t,"width"),height:(0,f.Ad)(l,t,"height"),src:r,alt:"image",sizes:"(max-width: 767px) 100vw, 50vw",placeholder:f.c8,className:"media-uploader_cldImage"})})}):s.jsx("div",{className:"media-uploader_cta",onClick:()=>e(),children:(0,s.jsxs)("div",{className:"media-uploader_cta-image",children:[s.jsx(B.default,{src:"/assets/icons/add.svg",alt:"ADD IMAGE",width:24,height:24}),s.jsx("p",{className:"p-14-medium",children:"Click hero to upload image"})]})})]})});var P=t(80810),J=t(5544),M=t(44551),q=t(97372);let Y=()=>{let e=(0,M.useRouter)();return s.jsx(q.aR,{defaultOpen:!0,children:(0,s.jsxs)(q._T,{children:[(0,s.jsxs)(q.fY,{children:[(0,s.jsxs)("div",{className:"flex-between",children:[s.jsx("p",{className:"p-16-semibold text-dark-400",children:"Insufficient Credits"}),s.jsx(q.le,{className:"border-0 p-0 hover:bg-transparent",onClick:()=>e.push("/profile"),children:s.jsx(B.default,{src:"/assets/icons/close.svg",alt:"credit coins",width:24,height:24,className:"cursor-pointer"})})]}),s.jsx(B.default,{src:"/assets/images/stacked-coins.png",alt:"credit coins",width:462,height:122}),s.jsx(q.f$,{className:"p-24-bold text-dark-600",children:"Oops.... Looks like you've run out of free credits!"}),s.jsx(q.yT,{className:"p-16-regular py-3",children:"No worries, though - you can keep enjoying our services by grabbing more credits."})]}),(0,s.jsxs)(q.xo,{children:[s.jsx(q.le,{className:"button w-full bg-purple-100 text-dark-400",onClick:()=>e.push("/profile"),children:"No, Cancel"}),s.jsx(q.OL,{className:"button w-full bg-purple-gradient  bg-cover",onClick:()=>e.push("/credits"),children:"Yes, Proceed"})]})]})})},G=i.z.object({title:i.z.string(),aspectRatio:i.z.string().optional(),color:i.z.string().optional(),prompt:i.z.string().optional(),publicId:i.z.string()}),H=({action:e,data:a=null,userId:t,type:i,creditBalance:d,config:n=null})=>{let c=D.vB[i],[m,x]=(0,o.useState)(a),[g,y]=(0,o.useState)(null),[w,v]=(0,o.useState)(!1),[R,S]=(0,o.useState)(!1),[k,C]=(0,o.useState)(n),[U,$]=(0,o.useTransition)(),z=(0,M.useRouter)(),O=a&&"Update"===e?{title:a?.title,aspectRatio:a?.aspectRatio,color:a?.color,prompt:a?.prompt,publicId:a?.publicId}:D.Pg,_=(0,l.cI)({resolver:(0,r.F)(G),defaultValues:O});async function T(s){if(console.log(s),v(!0),a||m){let r=(0,V.oy)({width:m?.width,height:m?.height,src:m?.publicId,...k}),l={title:s.title,publicId:m?.publicId,transformationType:i,width:m?.width,height:m?.height,config:k,secureURL:m?.secureURL,transformationURL:r,aspectRatio:s.aspectRatio,prompt:s.prompt,color:s.color};if("Add"===e)try{let e=await (0,J.mN)({image:l,userId:t,path:"/"});e&&(_.reset(),x(a),z.push(`/transformations/${e._id}`))}catch(e){console.log(e)}if("Update"===e)try{let e=await (0,J.gO)({image:{...l,_id:a._id},userId:t,path:`/transformations/${a._id}`});e&&z.push(`/transformations/${e._id}`)}catch(e){console.log(e)}}v(!1)}let L=(e,a)=>{let t=D.V3[e];return x(e=>({...e,aspectRatio:t.aspectRatio,width:t.width,height:t.height})),y(c.config),a(e)},B=(e,a,t,s)=>((0,f.Ds)(()=>{y(s=>({...s,[t]:{...s?.[t],["prompt"===e?"prompt":"to"]:a}}))},1e3)(),s(a)),q=async()=>{S(!0),C((0,f.ho)(g,k)),y(null),$(async()=>{await A(t,D.Mg)})};return(0,o.useEffect)(()=>{m&&("image-restore"===i||"remove-background-from-image"===i||"remove-shadow-from-photo"===i)&&y(c.config)},[m,c.config,i]),s.jsx(I,{..._,children:(0,s.jsxs)("form",{onSubmit:_.handleSubmit(T),className:"space-y-8",children:[d<Math.abs(D.Mg)&&s.jsx(Y,{}),s.jsx(F,{control:_.control,name:"title",formLabel:"Image Title",className:"w-full",render:({field:e})=>s.jsx(Z.I,{...e,className:"input-field"})}),"generative-fill"===i&&s.jsx(F,{control:_.control,name:"aspectRatio",formLabel:"Aspect Ratio",className:"w-full",render:({field:e})=>(0,s.jsxs)(u,{onValueChange:a=>L(a,e.onChange),value:e.value,children:[s.jsx(h,{className:"select-field",children:s.jsx(p,{placeholder:"Select size"})}),s.jsx(b,{children:Object.keys(D.V3).map(e=>s.jsx(N,{value:e,className:"select-item",children:D.V3[e].label},e))})]})}),("remove-object-from-photo"===i||"image-recolor"===i)&&(0,s.jsxs)("div",{className:"prompt-field",children:[s.jsx(F,{control:_.control,name:"prompt",formLabel:"remove-object-from-photo"===i?"Object to remove":"Object to recolor",className:"w-full",render:({field:e})=>s.jsx(Z.I,{value:e.value,className:"input-field",onChange:a=>B("prompt",a.target.value,i,e.onChange)})}),"image-recolor"==i&&s.jsx(F,{control:_.control,name:"color",formLabel:"Replacement Color",className:"w-full",render:({field:e})=>s.jsx(Z.I,{value:e.value,className:"input-field",onChange:a=>B("color",a.target.value,"recolor",e.onChange)})})]}),(0,s.jsxs)("div",{className:"media-uploader-field",children:[s.jsx(F,{control:_.control,name:"publicId",className:"flex size-full flex-col",render:({field:e})=>s.jsx(E,{onValueChange:e.onChange,setImage:x,publicId:e.value,image:m,type:i})}),s.jsx(P.default,{image:m,type:i,title:_.getValues().title,isTransforming:R,setIsTransforming:S,transformationConfig:k})]}),(0,s.jsxs)("div",{className:"flex flex-col gap-4 ",children:[s.jsx(j.z,{className:"submit-button capitalize",type:"button",disabled:R||null==g,onClick:q,children:R?"Transforming...":"Apply Transformation"}),s.jsx(j.z,{className:"submit-button capitalize",type:"submit",disabled:w,children:w?"Submitting":"Save Image"})]})]})})}},80810:(e,a,t)=>{t.r(a),t.d(a,{default:()=>o});var s=t(69805),r=t(98043),l=t(66275),i=t(47267);let o=({image:e,type:a,title:t,transformationConfig:o,isTransforming:d,setIsTransforming:n,hasDownload:c=!1})=>(0,s.jsxs)("div",{className:"flex flex-col gap-4",children:[(0,s.jsxs)("div",{className:"flex-between",children:[s.jsx("h3",{className:"h3-bold text-dark-600",children:"Transformed"}),c&&s.jsx("button",{className:"download-btn",onClick:a=>{a.preventDefault(),(0,i.LR)((0,l.oy)({width:e?.width,height:e?.height,src:e?.publicId,...o}),t)},children:s.jsx(r.default,{src:"/assets/icons/download.svg",alt:"Download",width:24,height:24,className:"pb-[6px]"})})]}),e?.publicId&&o?(0,s.jsxs)("div",{className:"relative",children:[s.jsx(l.bz,{width:(0,i.Ad)(a,e,"width"),height:(0,i.Ad)(a,e,"height"),src:e?.publicId,alt:e.title,sizes:"(max-width:767px) 100vw 50vw",placeholder:i.c8,className:"transformed-image",onLoad:()=>{n&&n(!1)},onError:()=>{(0,i.Ds)(()=>{n&&n(!1)},8e3)()},...o}),d&&(0,s.jsxs)("div",{className:"transforming-loader",children:[s.jsx(r.default,{src:"/assets/icons/spinner.svg",alt:"spinner",width:50,height:50}),s.jsx("p",{className:"text-white/80",children:"Please wait..."})]})]}):s.jsx("div",{className:"transformed-placeholder",children:"Transformed Image"})]})},97372:(e,a,t)=>{t.d(a,{OL:()=>g,_T:()=>f,aR:()=>d,f$:()=>h,fY:()=>u,le:()=>b,vW:()=>n,xo:()=>p,yT:()=>x});var s=t(69805),r=t(3327),l=t(468),i=t(47267),o=t(22091);let d=l.fC,n=l.xz,c=l.h_,m=r.forwardRef(({className:e,...a},t)=>s.jsx(l.aV,{className:(0,i.cn)("fixed inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",e),...a,ref:t}));m.displayName=l.aV.displayName;let f=r.forwardRef(({className:e,...a},t)=>(0,s.jsxs)(c,{children:[s.jsx(m,{}),s.jsx(l.VY,{ref:t,className:(0,i.cn)("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",e),...a})]}));f.displayName=l.VY.displayName;let u=({className:e,...a})=>s.jsx("div",{className:(0,i.cn)("flex flex-col space-y-2 text-center sm:text-left",e),...a});u.displayName="AlertDialogHeader";let p=({className:e,...a})=>s.jsx("div",{className:(0,i.cn)("flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2",e),...a});p.displayName="AlertDialogFooter";let h=r.forwardRef(({className:e,...a},t)=>s.jsx(l.Dx,{ref:t,className:(0,i.cn)("text-lg font-semibold",e),...a}));h.displayName=l.Dx.displayName;let x=r.forwardRef(({className:e,...a},t)=>s.jsx(l.dk,{ref:t,className:(0,i.cn)("text-sm text-muted-foreground",e),...a}));x.displayName=l.dk.displayName;let g=r.forwardRef(({className:e,...a},t)=>s.jsx(l.aU,{ref:t,className:(0,i.cn)((0,o.d)(),e),...a}));g.displayName=l.aU.displayName;let b=r.forwardRef(({className:e,...a},t)=>s.jsx(l.$j,{ref:t,className:(0,i.cn)((0,o.d)({variant:"outline"}),"mt-2 sm:mt-0",e),...a}));b.displayName=l.$j.displayName},74496:(e,a,t)=>{t.d(a,{I:()=>i});var s=t(69805),r=t(3327),l=t(47267);let i=r.forwardRef(({className:e,type:a,...t},r)=>s.jsx("input",{type:a,className:(0,l.cn)("flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-base ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",e),ref:r,...t}));i.displayName="Input"},5544:(e,a,t)=>{t.d(a,{ao:()=>i,gO:()=>l,mN:()=>r}),t(34298);var s=t(82679);(0,s.$)("51ee5b3c432bda2517692ab88bb54e3fca12ee4c");var r=(0,s.$)("934028fdc0be84685f832b78fc10dba1d10216a3"),l=(0,s.$)("902051a992baae2f5785ca7add274ba34cc7becb"),i=(0,s.$)("e22676a53c5de1d297ab088741d73b9758d0ed3b");(0,s.$)("dfd21a0dec0629a0528d8f07f8196a742310df7c"),(0,s.$)("7a9f1c74bb35fe3340284e9fafea878d42b8dc54")},6088:(e,a,t)=>{t.d(a,{Z:()=>r});var s=t(50798);let r=({title:e,subtitle:a})=>(0,s.jsxs)(s.Fragment,{children:[s.jsx("h1",{className:"h2-bold text-dark-600",children:e}),a&&s.jsx("p",{className:"p-16-regular mt-4",children:a})]})},67448:(e,a,t)=>{t.d(a,{ZP:()=>d});var s=t(389);let r=(0,s.createProxy)(String.raw`D:\visual studio code\project\learn React and Nextjs\imaginify\components\shared\TransformationForm.tsx`),{__esModule:l,$$typeof:i}=r,o=r.default;(0,s.createProxy)(String.raw`D:\visual studio code\project\learn React and Nextjs\imaginify\components\shared\TransformationForm.tsx#formSchema`);let d=o},43767:(e,a,t)=>{t.r(a),t.d(a,{createUser:()=>d,deleteUser:()=>m,getUserById:()=>n,updateCredits:()=>f,updateUser:()=>c});var s=t(88775);t(68775);var r=t(50060),l=t(21403),i=t(63647),o=t(88437);async function d(e){try{await (0,i.v)();let a=await l.Z.create(e);return JSON.parse(JSON.stringify(a))}catch(e){(0,o.S3)(e)}}async function n(e){try{await (0,i.v)();let a=await l.Z.findOne({clerkId:e});if(!a)throw Error("User not found");return JSON.parse(JSON.stringify(a))}catch(e){(0,o.S3)(e)}}async function c(e,a){try{await (0,i.v)();let t=await l.Z.findOneAndUpdate({clerkId:e},a,{new:!0});if(!t)throw Error("User update failed");return JSON.parse(JSON.stringify(t))}catch(e){(0,o.S3)(e)}}async function m(e){try{await (0,i.v)();let a=await l.Z.findOne({clerkId:e});if(!a)throw Error("User not found");let t=await l.Z.findByIdAndDelete(a._id);return(0,r.revalidatePath)("/"),t?JSON.parse(JSON.stringify(t)):null}catch(e){(0,o.S3)(e)}}async function f(e,a){try{await (0,i.v)();let t=await l.Z.findById(e);if(!t)throw Error("User not found");console.log("Current credits:",t.creditBalance),console.log("Adding credits:",a);let s=await l.Z.findByIdAndUpdate(e,{$inc:{creditBalance:a}},{new:!0});return console.log("Updated credits:",s.creditBalance),s}catch(e){throw console.error("Error updating credits:",e),(0,o.S3)(e),e}}(0,t(69303).h)([d,n,c,m,f]),(0,s.U)("142443fc102798e02caf7749c72c67d88cc0d1f9",d),(0,s.U)("9eeec8055808c1780baee03e37e448f0d44736f1",n),(0,s.U)("917bd2a2bbafa2bbf2cb903406452986486715b2",c),(0,s.U)("1bd2439848cce1253a71f69a051c88b31fb54b8f",m),(0,s.U)("865460400823edc85e8779e5b6640367cd36aa48",f)},21403:(e,a,t)=>{t.d(a,{Z:()=>l});var s=t(11185);let r=new s.Schema({clerkId:{type:String,required:!0,unique:!0},email:{type:String,required:!0,unique:!0},username:{type:String,required:!0,unique:!0},photo:{type:String,required:!0},firstName:{type:String},lastName:{type:String},planId:{type:Number,default:1},creditBalance:{type:Number,default:5}}),l=s.models?.User||(0,s.model)("User",r)},63647:(e,a,t)=>{t.d(a,{v:()=>o});var s=t(11185),r=t.n(s);let l=process.env.MONGODB_URL,i=global.mongoose;i||(i=global.mongoose={conn:null,promise:null});let o=async()=>{if(i.conn)return i.conn;if(!l)throw Error("Missing MONGODB_URL");return i.promise=i.promise||r().connect(l,{dbName:"cluster0",bufferCommands:!1}),i.conn=await i.promise,i.conn}}};