"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[933],{6933:function(e,t,a){a.r(t),a.d(t,{default:function(){return q},formSchema:function(){return Q}});var l=a(4297),r=a(6350),s=a(3897),o=a(2239),i=a(3812),n=a(7202),d=a(1964),c=a(3137),u=a(9411),m=a(5517);let f=n.fC;n.ZA;let p=n.B4,h=i.forwardRef((e,t)=>{let{className:a,children:r,...s}=e;return(0,l.jsxs)(n.xz,{ref:t,className:(0,m.cn)("flex h-10 w-full items-center justify-between rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background data-[placeholder]:text-muted-foreground focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 [&>span]:line-clamp-1",a),...s,children:[r,(0,l.jsx)(n.JO,{asChild:!0,children:(0,l.jsx)(d.Z,{className:"h-4 w-4 opacity-50"})})]})});h.displayName=n.xz.displayName;let x=i.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,l.jsx)(n.u_,{ref:t,className:(0,m.cn)("flex cursor-default items-center justify-center py-1",a),...r,children:(0,l.jsx)(c.Z,{className:"h-4 w-4"})})});x.displayName=n.u_.displayName;let g=i.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,l.jsx)(n.$G,{ref:t,className:(0,m.cn)("flex cursor-default items-center justify-center py-1",a),...r,children:(0,l.jsx)(d.Z,{className:"h-4 w-4"})})});g.displayName=n.$G.displayName;let b=i.forwardRef((e,t)=>{let{className:a,children:r,position:s="popper",...o}=e;return(0,l.jsx)(n.h_,{children:(0,l.jsxs)(n.VY,{ref:t,className:(0,m.cn)("relative z-50 max-h-96 min-w-[8rem] overflow-hidden rounded-md border bg-popover text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2","popper"===s&&"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1",a),position:s,...o,children:[(0,l.jsx)(x,{}),(0,l.jsx)(n.l_,{className:(0,m.cn)("p-1","popper"===s&&"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)]"),children:r}),(0,l.jsx)(g,{})]})})});b.displayName=n.VY.displayName,i.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,l.jsx)(n.__,{ref:t,className:(0,m.cn)("py-1.5 pl-8 pr-2 text-sm font-semibold",a),...r})}).displayName=n.__.displayName;let v=i.forwardRef((e,t)=>{let{className:a,children:r,...s}=e;return(0,l.jsxs)(n.ck,{ref:t,className:(0,m.cn)("relative flex w-full cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",a),...s,children:[(0,l.jsx)("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:(0,l.jsx)(n.wU,{children:(0,l.jsx)(u.Z,{className:"h-4 w-4"})})}),(0,l.jsx)(n.eT,{children:r})]})});v.displayName=n.ck.displayName,i.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,l.jsx)(n.Z0,{ref:t,className:(0,m.cn)("-mx-1 my-1 h-px bg-muted",a),...r})}).displayName=n.Z0.displayName;var j=a(7366),N=a(1218),w=a(4232);let y=(0,a(8355).j)("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),R=i.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,l.jsx)(w.f,{ref:t,className:(0,m.cn)(y(),a),...r})});R.displayName=w.f.displayName;let I=s.RV,C=i.createContext({}),k=e=>{let{...t}=e;return(0,l.jsx)(C.Provider,{value:{name:t.name},children:(0,l.jsx)(s.Qr,{...t})})},_=()=>{let e=i.useContext(C),t=i.useContext(z),{getFieldState:a,formState:l}=(0,s.Gc)(),r=a(e.name,l);if(!e)throw Error("useFormField should be used within <FormField>");let{id:o}=t;return{id:o,name:e.name,formItemId:"".concat(o,"-form-item"),formDescriptionId:"".concat(o,"-form-item-description"),formMessageId:"".concat(o,"-form-item-message"),...r}},z=i.createContext({}),S=i.forwardRef((e,t)=>{let{className:a,...r}=e,s=i.useId();return(0,l.jsx)(z.Provider,{value:{id:s},children:(0,l.jsx)("div",{ref:t,className:(0,m.cn)("space-y-2",a),...r})})});S.displayName="FormItem";let F=i.forwardRef((e,t)=>{let{className:a,...r}=e,{error:s,formItemId:o}=_();return(0,l.jsx)(R,{ref:t,className:(0,m.cn)(s&&"text-destructive",a),htmlFor:o,...r})});F.displayName="FormLabel";let L=i.forwardRef((e,t)=>{let{...a}=e,{error:r,formItemId:s,formDescriptionId:o,formMessageId:i}=_();return(0,l.jsx)(N.g7,{ref:t,id:s,"aria-describedby":r?"".concat(o," ").concat(i):"".concat(o),"aria-invalid":!!r,...a})});L.displayName="FormControl",i.forwardRef((e,t)=>{let{className:a,...r}=e,{formDescriptionId:s}=_();return(0,l.jsx)("p",{ref:t,id:s,className:(0,m.cn)("text-sm text-muted-foreground",a),...r})}).displayName="FormDescription";let T=i.forwardRef((e,t)=>{var a;let{className:r,children:s,...o}=e,{error:i,formMessageId:n}=_(),d=i?String(null!==(a=null==i?void 0:i.message)&&void 0!==a?a:""):s;return d?(0,l.jsx)("p",{ref:t,id:n,className:(0,m.cn)("text-sm font-medium text-destructive",r),...o,children:d}):null});T.displayName="FormMessage";var V=a(3246),O=a(2634);let A=e=>{let{control:t,render:a,name:r,formLabel:s,className:o}=e;return(0,l.jsx)(k,{control:t,name:r,render:e=>{let{field:t}=e;return(0,l.jsxs)(S,{className:o,children:[s&&(0,l.jsx)(F,{children:s}),(0,l.jsx)(L,{children:a({field:t})}),(0,l.jsx)(T,{})]})}})};a(6282);var Z=a(7433),$=(0,Z.$)("865460400823edc85e8779e5b6640367cd36aa48");(0,Z.$)("142443fc102798e02caf7749c72c67d88cc0d1f9"),(0,Z.$)("9eeec8055808c1780baee03e37e448f0d44736f1"),(0,Z.$)("917bd2a2bbafa2bbf2cb903406452986486715b2"),(0,Z.$)("1bd2439848cce1253a71f69a051c88b31fb54b8f");var M=a(3091),U=a(2001),E=a(4717),P=e=>{let{onValueChange:t,setImage:a,image:r,publicId:s,type:o}=e;return(0,l.jsx)(U.ZF,{uploadPreset:"JSM_imaginify",options:{multiple:!1,resourceType:"image"},onSuccess:e=>{var l;a(t=>{var a,l,r,s;return{...t,publicId:null==e?void 0:null===(a=e.info)||void 0===a?void 0:a.public_id,width:null==e?void 0:null===(l=e.info)||void 0===l?void 0:l.width,height:null==e?void 0:null===(r=e.info)||void 0===r?void 0:r.height,secureURL:null==e?void 0:null===(s=e.info)||void 0===s?void 0:s.secure_url}}),t(null==e?void 0:null===(l=e.info)||void 0===l?void 0:l.public_id),M.toast.success("Image uploaded successfully",{description:"1 credit was deducted from your account",duration:5e3,className:"success-toast"})},onError:()=>{M.toast.success("Something went wrong while uploading",{description:"Please try again",duration:5e3,className:"error-toast"})},children:e=>{let{open:t}=e;return(0,l.jsxs)("div",{className:"flex flex-col gap-4",children:[(0,l.jsx)("h3",{className:"h3-bold text-dark-600",children:"Original"}),s?(0,l.jsx)(l.Fragment,{children:(0,l.jsx)("div",{className:"cursor-pointer overflow-hidden rounde-[10px",children:(0,l.jsx)(U.bz,{width:(0,m.Ad)(o,r,"width"),height:(0,m.Ad)(o,r,"height"),src:s,alt:"image",sizes:"(max-width: 767px) 100vw, 50vw",placeholder:m.c8,className:"media-uploader_cldImage"})})}):(0,l.jsx)("div",{className:"media-uploader_cta",onClick:()=>t(),children:(0,l.jsxs)("div",{className:"media-uploader_cta-image",children:[(0,l.jsx)(E.default,{src:"/assets/icons/add.svg",alt:"ADD IMAGE",width:24,height:24}),(0,l.jsx)("p",{className:"p-14-medium",children:"Click hero to upload image"})]})})]})}})},D=a(6684),G=a(8485),Y=a(3025),B=a(9509);let J=()=>{let e=(0,Y.useRouter)();return(0,l.jsx)(B.aR,{defaultOpen:!0,children:(0,l.jsxs)(B._T,{children:[(0,l.jsxs)(B.fY,{children:[(0,l.jsxs)("div",{className:"flex-between",children:[(0,l.jsx)("p",{className:"p-16-semibold text-dark-400",children:"Insufficient Credits"}),(0,l.jsx)(B.le,{className:"border-0 p-0 hover:bg-transparent",onClick:()=>e.push("/profile"),children:(0,l.jsx)(E.default,{src:"/assets/icons/close.svg",alt:"credit coins",width:24,height:24,className:"cursor-pointer"})})]}),(0,l.jsx)(E.default,{src:"/assets/images/stacked-coins.png",alt:"credit coins",width:462,height:122}),(0,l.jsx)(B.f$,{className:"p-24-bold text-dark-600",children:"Oops.... Looks like you've run out of free credits!"}),(0,l.jsx)(B.yT,{className:"p-16-regular py-3",children:"No worries, though - you can keep enjoying our services by grabbing more credits."})]}),(0,l.jsxs)(B.xo,{children:[(0,l.jsx)(B.le,{className:"button w-full bg-purple-100 text-dark-400",onClick:()=>e.push("/profile"),children:"No, Cancel"}),(0,l.jsx)(B.OL,{className:"button w-full bg-purple-gradient  bg-cover",onClick:()=>e.push("/credits"),children:"Yes, Proceed"})]})]})})},Q=o.z.object({title:o.z.string(),aspectRatio:o.z.string().optional(),color:o.z.string().optional(),prompt:o.z.string().optional(),publicId:o.z.string()});var q=e=>{let{action:t,data:a=null,userId:o,type:n,creditBalance:d,config:c=null}=e,u=O.vB[n],[x,g]=(0,i.useState)(a),[N,w]=(0,i.useState)(null),[y,R]=(0,i.useState)(!1),[C,k]=(0,i.useState)(!1),[_,z]=(0,i.useState)(c),[S,F]=(0,i.useTransition)(),L=(0,Y.useRouter)(),T=a&&"Update"===t?{title:null==a?void 0:a.title,aspectRatio:null==a?void 0:a.aspectRatio,color:null==a?void 0:a.color,prompt:null==a?void 0:a.prompt,publicId:null==a?void 0:a.publicId}:O.Pg,Z=(0,s.cI)({resolver:(0,r.F)(Q),defaultValues:T});async function M(e){if(console.log(e),R(!0),a||x){let l=(0,U.oy)({width:null==x?void 0:x.width,height:null==x?void 0:x.height,src:null==x?void 0:x.publicId,..._}),r={title:e.title,publicId:null==x?void 0:x.publicId,transformationType:n,width:null==x?void 0:x.width,height:null==x?void 0:x.height,config:_,secureURL:null==x?void 0:x.secureURL,transformationURL:l,aspectRatio:e.aspectRatio,prompt:e.prompt,color:e.color};if("Add"===t)try{let e=await (0,G.mN)({image:r,userId:o,path:"/"});e&&(Z.reset(),g(a),L.push("/transformations/".concat(e._id)))}catch(e){console.log(e)}if("Update"===t)try{let e=await (0,G.gO)({image:{...r,_id:a._id},userId:o,path:"/transformations/".concat(a._id)});e&&L.push("/transformations/".concat(e._id))}catch(e){console.log(e)}}R(!1)}let E=(e,t)=>{let a=O.V3[e];return g(e=>({...e,aspectRatio:a.aspectRatio,width:a.width,height:a.height})),w(u.config),t(e)},B=(e,t,a,l)=>((0,m.Ds)(()=>{w(l=>({...l,[a]:{...null==l?void 0:l[a],["prompt"===e?"prompt":"to"]:t}}))},1e3)(),l(t)),q=async()=>{k(!0),z((0,m.ho)(N,_)),w(null),F(async()=>{await $(o,O.Mg)})};return(0,i.useEffect)(()=>{x&&("image-restore"===n||"remove-background-from-image"===n||"remove-shadow-from-photo"===n)&&w(u.config)},[x,u.config,n]),(0,l.jsx)(I,{...Z,children:(0,l.jsxs)("form",{onSubmit:Z.handleSubmit(M),className:"space-y-8",children:[d<Math.abs(O.Mg)&&(0,l.jsx)(J,{}),(0,l.jsx)(A,{control:Z.control,name:"title",formLabel:"Image Title",className:"w-full",render:e=>{let{field:t}=e;return(0,l.jsx)(V.I,{...t,className:"input-field"})}}),"generative-fill"===n&&(0,l.jsx)(A,{control:Z.control,name:"aspectRatio",formLabel:"Aspect Ratio",className:"w-full",render:e=>{let{field:t}=e;return(0,l.jsxs)(f,{onValueChange:e=>E(e,t.onChange),value:t.value,children:[(0,l.jsx)(h,{className:"select-field",children:(0,l.jsx)(p,{placeholder:"Select size"})}),(0,l.jsx)(b,{children:Object.keys(O.V3).map(e=>(0,l.jsx)(v,{value:e,className:"select-item",children:O.V3[e].label},e))})]})}}),("remove-object-from-photo"===n||"image-recolor"===n)&&(0,l.jsxs)("div",{className:"prompt-field",children:[(0,l.jsx)(A,{control:Z.control,name:"prompt",formLabel:"remove-object-from-photo"===n?"Object to remove":"Object to recolor",className:"w-full",render:e=>{let{field:t}=e;return(0,l.jsx)(V.I,{value:t.value,className:"input-field",onChange:e=>B("prompt",e.target.value,n,t.onChange)})}}),"image-recolor"==n&&(0,l.jsx)(A,{control:Z.control,name:"color",formLabel:"Replacement Color",className:"w-full",render:e=>{let{field:t}=e;return(0,l.jsx)(V.I,{value:t.value,className:"input-field",onChange:e=>B("color",e.target.value,"recolor",t.onChange)})}})]}),(0,l.jsxs)("div",{className:"media-uploader-field",children:[(0,l.jsx)(A,{control:Z.control,name:"publicId",className:"flex size-full flex-col",render:e=>{let{field:t}=e;return(0,l.jsx)(P,{onValueChange:t.onChange,setImage:g,publicId:t.value,image:x,type:n})}}),(0,l.jsx)(D.default,{image:x,type:n,title:Z.getValues().title,isTransforming:C,setIsTransforming:k,transformationConfig:_})]}),(0,l.jsxs)("div",{className:"flex flex-col gap-4 ",children:[(0,l.jsx)(j.z,{className:"submit-button capitalize",type:"button",disabled:C||null==N,onClick:q,children:C?"Transforming...":"Apply Transformation"}),(0,l.jsx)(j.z,{className:"submit-button capitalize",type:"submit",disabled:y,children:y?"Submitting":"Save Image"})]})]})})}},3246:function(e,t,a){a.d(t,{I:function(){return o}});var l=a(4297),r=a(3812),s=a(5517);let o=r.forwardRef((e,t)=>{let{className:a,type:r,...o}=e;return(0,l.jsx)("input",{type:r,className:(0,s.cn)("flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-base ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",a),ref:t,...o})});o.displayName="Input"}}]);